"use strict";(self.webpackChunksn_pot=self.webpackChunksn_pot||[]).push([[8525],{3905:(e,t,n)=>{n.d(t,{Zo:()=>m,kt:()=>u});var a=n(67294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var p=a.createContext({}),s=function(e){var t=a.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},m=function(e){var t=s(e.components);return a.createElement(p.Provider,{value:t},e.children)},d="mdxType",c={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},k=a.forwardRef((function(e,t){var n=e.components,i=e.mdxType,r=e.originalType,p=e.parentName,m=l(e,["components","mdxType","originalType","parentName"]),d=s(n),k=i,u=d["".concat(p,".").concat(k)]||d[k]||c[k]||r;return n?a.createElement(u,o(o({ref:t},m),{},{components:n})):a.createElement(u,o({ref:t},m))}));function u(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var r=n.length,o=new Array(r);o[0]=k;var l={};for(var p in t)hasOwnProperty.call(t,p)&&(l[p]=t[p]);l.originalType=e,l[d]="string"==typeof e?e:i,o[1]=l;for(var s=2;s<r;s++)o[s]=n[s];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}k.displayName="MDXCreateElement"},55095:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>o,default:()=>c,frontMatter:()=>r,metadata:()=>l,toc:()=>s});var a=n(87462),i=(n(67294),n(3905));const r={sidebar_position:11},o="Automated Multi Tenancy",l={unversionedId:"IBM SevOne Automated Network Observability/RNA Labs/multitenant",id:"IBM SevOne Automated Network Observability/RNA Labs/multitenant",title:"Automated Multi Tenancy",description:"Overview",source:"@site/docs/IBM SevOne Automated Network Observability/RNA Labs/multitenant.md",sourceDirName:"IBM SevOne Automated Network Observability/RNA Labs",slug:"/IBM SevOne Automated Network Observability/RNA Labs/multitenant",permalink:"/software-networking-pot/docs/IBM SevOne Automated Network Observability/RNA Labs/multitenant",draft:!1,tags:[],version:"current",sidebarPosition:11,frontMatter:{sidebar_position:11},sidebar:"tutorialSidebar",previous:{title:"Automated Cross Object Calculation",permalink:"/software-networking-pot/docs/IBM SevOne Automated Network Observability/RNA Labs/coc"},next:{title:"Kubernetes Container Monitoring",permalink:"/software-networking-pot/docs/IBM SevOne Automated Network Observability/RNA Labs/di_ebpf"}},p={},s=[{value:"Overview",id:"overview",level:2},{value:"Create Workflow",id:"create-workflow",level:2},{value:"Review",id:"review",level:2}],m={toc:s},d="wrapper";function c(e){let{components:t,...r}=e;return(0,i.kt)(d,(0,a.Z)({},m,r,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"automated-multi-tenancy"},"Automated Multi Tenancy"),(0,i.kt)("h2",{id:"overview"},"Overview"),(0,i.kt)("p",null,"SevOne is a multitenant solution that allows us to create different users that will have different access to devices, different permissions, different reports and even different look and feel, allowing us to completely separate users or tenants among them."),(0,i.kt)("p",null,"In this lab we will review how we can fully automate the creation of multiple tenants from a list of devices."),(0,i.kt)("p",null,"The process to fully create a new tenant will be the following, from a list of devices that contains name of the device, IP address, SNMP community string and customer/tenant, we will go through each of them and:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Check if there is a device group created for that tenant, if there isn't we will create a new one")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Check if the device is already monitored, if it isn't we will monitor it")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Add the device into the device group")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Check if the tenant has already a user role create, if there isn't we will create a new one and assign permissions and access to the device group created")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Check if there is any user assigned to that user role, if there isn't we will create a new user and assign it to that user role")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Check if the tenant is created in DI, if it isn't we will create a new tenant in DI and assign the default authentication datasource to the tenant"))),(0,i.kt)("h2",{id:"create-workflow"},"Create Workflow"),(0,i.kt)("p",null,"If SevOne authentication has already been created, please skip this block of actions and continue to step 4."),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Log into SANO automation platform")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Go to Authentications")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Click  Create Authentication"),(0,i.kt)("p",{parentName:"li"},"a. Name: SevOne"),(0,i.kt)("p",{parentName:"li"},"b. Service: SevOne"),(0,i.kt)("p",{parentName:"li"},"c. ",(0,i.kt)("strong",{parentName:"p"},"Protocol: http://")," (<-- important)"),(0,i.kt)("p",{parentName:"li"},"d. Host: 10.0.0.10"),(0,i.kt)("p",{parentName:"li"},"e. Username: admin"),(0,i.kt)("p",{parentName:"li"},"f. Password: SevOne"))),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"IBM SevOne Automated Network Observability",src:n(83351).Z,width:"579",height:"758"})),(0,i.kt)("ol",{start:4},(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Go to Workflows and click on Create Workflow"),(0,i.kt)("p",{parentName:"li"},"a. Name: SevOne Device Onboarding including Tenant"),(0,i.kt)("p",{parentName:"li"},"b. Layout type: Sequence")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Add variables to Start"),(0,i.kt)("p",{parentName:"li"},"a. NMSCredentials"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre"},'i. Name: NMSCredentials\n\nii. Type: Authentication -> SevOne\n\niii. Default Value: "admin/SevOne"\n\niv. In\n\nv. Required\n')),(0,i.kt)("p",{parentName:"li"},"b. ListDevices"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre"},'i. Name: ListDevices\n\nii. Type: list\n\niii. Default Value:\n    [\n        { \n            "device": {\n                "name": "MAD-FW01",\n                "ip": "172.24.147.228",\n                "snmp": "public",\n                "customer": "CustomerA"\n            }\n        },\n        { \n            "device": {\n                "name": "MAD-FW02",\n                "ip": "172.24.147.130",\n                "snmp": "public",\n                "customer": "CustomerA"\n            }\n        },\n        { \n            "device": {\n                "name": "BRG-EDGE01",\n                "ip": "172.24.147.5",\n                "snmp": "public",\n                "customer": "CustomerB"\n            }\n        }\n\n    ]\n\niv. In\n\nv. Required\n')),(0,i.kt)("p",{parentName:"li"},"c. devicegroupparentid"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre"},"i. Name: devicegroupparentid\n\nii. Type: Number\n\niii. Default Value: 2\n")),(0,i.kt)("p",{parentName:"li"},"d. IPAddressDI"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre"},'i. Name: IPAddressDI\n\nii. Type: String\n\niii. Default Value: "10.0.0.11"\n\niv. In\n\nv. Required\n')),(0,i.kt)("p",{parentName:"li"},"e. DIuser"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre"},'i. Name: DIuser\n\nii. Type: String\n\niii. Default Value: "admin"\n\niv. In\n\nv. Required\n')),(0,i.kt)("p",{parentName:"li"},"f. DIpass"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre"},'i. Name: DIpass\n\nii. Type: String\n\niii. Default Value: "SevOne"\n\niv. In\n\nv. Required\n')))),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"IBM SevOne Automated Network Observability",src:n(81773).Z,width:"1467",height:"531"})),(0,i.kt)("ol",{start:6},(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Change to Flow View")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"On the left hand side panel, click on Common")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},'Select "ForEach" and drop it after the building block START'),(0,i.kt)("p",{parentName:"li"},"a. Change name to ForEach_Device"),(0,i.kt)("p",{parentName:"li"},"b. Click on the building block to open the right side panel and complete the following fields"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre"},"i. list: $ListDevices\n"))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Add a comment:"),(0,i.kt)("p",{parentName:"li"},"a. Check Device Group")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Add a new building block, SevOne -> REST v3 -> Device Groups -> Device Groups Filter Device Groups"),(0,i.kt)("p",{parentName:"li"},"a. Change name to SevOne_Find_Device_Group"),(0,i.kt)("p",{parentName:"li"},"b. Click on the building block to open the right side panel and complete the following fields"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre"},"i. authKey: $NMSCredentials\n\nii. body: \n\n    1. name: $ForEach_Device.item.device.customer\n"))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Add a new building block, Common -> If"),(0,i.kt)("p",{parentName:"li"},"a. Change name to If_Group_Not_found"),(0,i.kt)("p",{parentName:"li"},"b. Click on the building block to open the right side panel and complete the following fields"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre"},"i. condition: $SevOne_Find_Device_Group.result.totalElements == 0\n"))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"On the FALSE branch of the IF, add a new building block, Common -> Assign"),(0,i.kt)("p",{parentName:"li"},"a. Change name to Assign_devicegroupid"),(0,i.kt)("p",{parentName:"li"},"b. Click on the building block to open the right side panel and complete the following fields"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre"},"i. variable: $devicegroupid\n\nii. value: $SevOne_Find_Device_Group.result.content[0].id\n"))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"On the TRUE branch of the if, add a new building block, SevOne -> REST v3 -> Device Groups -> Device Groups Create Device Group"),(0,i.kt)("p",{parentName:"li"},"a. Change name to SevOne_Create_Device_Group"),(0,i.kt)("p",{parentName:"li"},"b. Click on the building block to open the right side panel and complete the following fields"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre"},"i. authKey: $NMSCredentials\n\nii. body: \n\n    1. name: $ForEach_Device.item.device.customer\n    \n    2. parentid: $devicegroupparentid\n    \n"))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Add a new building block, Common -> Assign"),(0,i.kt)("p",{parentName:"li"},"a. Change name to Assign_devicegroupid2"),(0,i.kt)("p",{parentName:"li"},"b. Click on the building block to open the right side panel and complete the following fields"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre"},"i. variable: $devicegroupid\n\nii. value: $SevOne_Create_Device_Group.result.id\n")))),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"IBM SevOne Automated Network Observability",src:n(70692).Z,width:"855",height:"697"})),(0,i.kt)("ol",{start:15},(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"After the end of the IF, add a comment"),(0,i.kt)("p",{parentName:"li"},"a. Create Device")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Add a new building block, SevOne -> REST v3 -> Metadata -> Metadata Devices (POST)"),(0,i.kt)("p",{parentName:"li"},"a. Change name to SevOne_Find_Device"),(0,i.kt)("p",{parentName:"li"},"b. Click on the building block to open the right side panel and complete the following fields"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre"},"i. authKey: $NMSCredentials\n\nii. body: \n\n    1. name: \n    \n        a. value: $ForEach_Device.item.device.name\n    \n")))),(0,i.kt)("ol",{start:17},(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Add a new building block, Common -> If"),(0,i.kt)("p",{parentName:"li"},"a. Change name to If_Device_Not_Found"),(0,i.kt)("p",{parentName:"li"},"b. Click on the building block to open the right side panel and complete the following fields"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre"},"i. condition: $SevOne_Find_Device.result.devices.length == 0\n"))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"On the FALSE branch of the IF, add a new building block, Common -> Assign"),(0,i.kt)("p",{parentName:"li"},"a. Change name to Assign_deviceid"),(0,i.kt)("p",{parentName:"li"},"b. Click on the building block to open the right side panel and complete the following fields"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre"},"i. variable: $deviceid\n\nii. value: $SevOne_Find_Device.result.devices[0].id\n"))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"On the 'TRUE' branch of the If, add a new building block, SevOne -> Rest v2 -> Devices -> Create Device"),(0,i.kt)("p",{parentName:"li"},"a. Change name to SevOne_Create_Device"),(0,i.kt)("p",{parentName:"li"},"b. Click on the building block to open the right side panel and complete the following fields"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre"},'i. authKey: $NMSCredentials\n\nii. body:\n\n    1. name: $ForEach_Device.item.device.name\n    \n    2. ipAddress: $ForEach_Device.item.device.ip\n    \n    3. description: $ForEach_Device.item.device.name\n    \n    4. pluginInfo: \n    \n        {\n            "1": {\n                "extendedInfo": {\n                    "snmpVersion": "2",\n                    "roCommunity": $ForEach_Device.item.device.snmp,\n                    "snmpPort": "161"\n                },\n                "enabled": true\n            },\n            "2": {\n                "extendedInfo": {\n                    "packetInterval": "0",\n                    "packetNumber": "5",\n                    "packetSize": "64"\n                },\n                "enabled": true\n            }\n        }\n'))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Add a new building block, Common -> Assign"),(0,i.kt)("p",{parentName:"li"},"a. Change name to Assign_device2"),(0,i.kt)("p",{parentName:"li"},"b. Click on the building block to open the right side panel and complete the following fields"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre"},"i. variable: $deviceid\n\nii. item: $SevOne_Create_Device.result.id\n")))),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"IBM SevOne Automated Network Observability",src:n(76552).Z,width:"715",height:"621"}),"\t\t"),(0,i.kt)("ol",{start:21},(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"After the end of the IF, add a comment"),(0,i.kt)("p",{parentName:"li"},"a. Add Device to Group")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Add a new building block, SevOne -> REST v3 -> Device Groups -> Device Groups Add Device to Device Groups"),(0,i.kt)("p",{parentName:"li"},"a. Change name to SevOne_add_device_To_Group"),(0,i.kt)("p",{parentName:"li"},"b. Click on the building block to open the right side panel and complete the following fields"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre"},"i. authKey: $NMSCredentials\n\nii. id: $devicegroupid\n\niii. deviceid: $deviceid\n"))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Add a comment"))),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"a. Check User Role\n")),(0,i.kt)("ol",{start:24},(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Add a new building block, Sevone -> REST v2 -> Roles -> Filter Roles"),(0,i.kt)("p",{parentName:"li"},"a. Change name to SevOne_Find_Role"),(0,i.kt)("p",{parentName:"li"},"b. Click on the building block to open the right side panel and complete the following fields"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre"},"i. authKey: $NMSCredentials\n\nii. roleFilter:\n\n    1. name: $ForEach_Device.item.device.customer\n"))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Add a new building block, Common -> If"),(0,i.kt)("p",{parentName:"li"},"a. Change name to If_Role_Not_Found"),(0,i.kt)("p",{parentName:"li"},"b. Click on the building block to open the right side panel and complete the following fields"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre"},"i. condition: $SevOne_Find_Role.result.totalElements == 0\n"))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"On the FALSE branch of the If, add a new building block, Common -> Assign"),(0,i.kt)("p",{parentName:"li"},"a. Change name to Assign_roleid"),(0,i.kt)("p",{parentName:"li"},"b. Click on the building block to open the right side panel and complete the following fields"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre"},"i. variable: $roleid\n\nii. value: $SevOne_Find_Role.result.content[0].id\n"))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"On the TRUE branch of the If, add a new building block, SevOne -> REST v2 -> Roles -> Create Role"),(0,i.kt)("p",{parentName:"li"},"a. Change name to SevOne_Create_Role"),(0,i.kt)("p",{parentName:"li"},"b. Click on the building block to open the right side panel and complete the following fields"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre"},"i. authKey: $NMSCredentials\n\nii. role:\n\n    1. name: $ForEach_Device.item.device.customer\n    \n    2. parentId: 3\n"))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Add a new building block, Common -> Assign"))),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"a. Change name to Assign_roleid2\n\nb. Click on the building block to open the right side panel and complete the following fields\n\n    i. variable: $roleid\n    \n    ii. value: $SevOne_Create_Role.result.id\n    \n")),(0,i.kt)("ol",{start:29},(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Add a new building block, SevOne -> REST v2 -> Permissions -> Update Device Group Permissions2"),(0,i.kt)("p",{parentName:"li"},"a. Change name to SevOne_Update_Permissions "),(0,i.kt)("p",{parentName:"li"},"b. Click on the building block to open the right side panel and complete the following fields"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre"},"i. authKey: $NMSCredentials\n\nii. dto:\n\n    1. canViewGroup: true\n    \n    2. canViewGroupMembers: true\n    \niii. id: $devicegroupid\n\niv. roleId: $roleid\n")))),(0,i.kt)("ol",{start:30},(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Add a new building block, SevOne -> REST v2 -> Permissions -> Update Access Permissions"),(0,i.kt)("p",{parentName:"li"},"a. Change name to SevOne_Update_Access"))),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},'b. Click on the building block to open the right side panel and complete the following fields\n\n    i. authKey: $NMSCredentials\n\n    ii. permissions: [\n                        "VIEW_NETFLOW",\n                        "VIEW_REPORTS",\n                        "VIEW_ALERTS",\n                        "VIEW_ALERT_HISTORY",\n                        "RECEIVE_ALERTS"\n                    ]\n                    \n    iii. roleId: $roleid\n    \n')),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"IBM SevOne Automated Network Observability",src:n(83524).Z,width:"769",height:"686"}),"\t"),(0,i.kt)("ol",{start:31},(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"After the end of the IF, add a comment"),(0,i.kt)("p",{parentName:"li"},"a. Check First User")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Add a new building block, SevOne -> REST v3 -> Users -> Users Users (POST)"),(0,i.kt)("p",{parentName:"li"},"a. Change name to SevOne_Find_User"),(0,i.kt)("p",{parentName:"li"},"b. Click on the building block to open the right side panel and complete the following fields"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre"},"i. authKey: $NMSCredentials\n\nii. body:\n\n    1. roles:\n    \n        a. ids: [ $roleid ]\n"))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Add a new building block, Common -> If"),(0,i.kt)("p",{parentName:"li"},"a. Change name to If_User_Not_Found"),(0,i.kt)("p",{parentName:"li"},"b. Click on the building block to open the right side panel and complete the following fields"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre"},"i. condition: $SevOne_Find_User.result.users.length == 0\n"))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"On the TRUE branch of the If, add a new building block, SevOne -> REST v2 -> Users -> Create User Using POST"),(0,i.kt)("p",{parentName:"li"},"a. Change name to SevOne_Create_User"),(0,i.kt)("p",{parentName:"li"},"b. Click on the building block to open the right side panel and complete the following fields"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre"},'i. authKey: $NMSCredentials\n\nii. user:\n\n    1. authentication: SEVONE\n    \n    2. email: "a@a.com"\n    \n    3. firstName: $ForEach_Device.item.device.customer\n    \n    4. isActive: true\n    \n    5. lastName: $ForEach_Device.item.device.customer\n    \n    6. password: $ForEach_Device.item.device.customer\n    \n    7. roleIds: [ $roleid ]\n    \n    8. username: $ForEach_Device.item.device.customer\n')))),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"IBM SevOne Automated Network Observability",src:n(1066).Z,width:"603",height:"531"}),"\t"),(0,i.kt)("ol",{start:35},(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"After the end of the IF, add a comment"),(0,i.kt)("p",{parentName:"li"},"a. Check Tenant in DI")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Add a new buildig block, Common -> HttpRequest"),(0,i.kt)("p",{parentName:"li"},"a. Change name to HttpRequest_Get_DI_Token"),(0,i.kt)("p",{parentName:"li"},"b. Click on the building block to open the right side panel and complete the following fields"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre"},'i. method: POST\n\nii. host: $IPAddressDI+"/retinaserver"\n\niii. protocol: https\n\niv. headers:\n\n        {\n            "Content-Type": "application/json"\n        }\n        \nv. body: "{\\"query\\":\\"mutation {\\\\r\\\\n    authenticate(tenant: \\\\\\"SevOne\\\\\\", name: \\\\\\""+$DIuser+"\\\\\\", password:\\\\\\""+$DIpass+"\\\\\\") {\\\\r\\\\n        token\\\\r\\\\n    }\\\\r\\\\n}\\",\\"variables\\":{}}"\n'))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Add a new buildig block, Common -> HttpRequest"),(0,i.kt)("p",{parentName:"li"},"a. Change name to HttpRequest_Find_Tenant"),(0,i.kt)("p",{parentName:"li"},"b. Click on the building block to open the right side panel and complete the following fields"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre"},'i. method: POST\n\nii. host: $IPAddressDI+"/retinaserver"\n\niii. protocol: https\n\niv. headers:\n\n        {\n            "Content-Type": "application/json",\n            "X-Auth-Token": $HttpRequest_Get_DI_Token.result.data.authenticate.token\n        }\n        \nv. body: "{\\"query\\":\\"query {\\\\r\\\\n    tenants (\\\\r\\\\n        name: \\\\\\"" + $ForEach_Device.item.device.customer + "\\\\\\"\\\\r\\\\n    )\\\\r\\\\n    {\\\\r\\\\n        id\\\\r\\\\n        name\\\\r\\\\n    }\\\\r\\\\n}\\",\\"variables\\":{}}"\n'))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Add a new building block, Common -> If"),(0,i.kt)("p",{parentName:"li"},"a. Change name to If_Tenant_Not_Found"),(0,i.kt)("p",{parentName:"li"},"b. Click on the building block to open the right side panel and complete the following fields"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre"},"i. condition: $HttpRequest_Find_Tenant.result.errors\n")))),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"IBM SevOne Automated Network Observability",src:n(38940).Z,width:"569",height:"488"}),"\t"),(0,i.kt)("ol",{start:39},(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"On the TRUE branch of the If, add a new buildig block, Common -> HttpRequest"),(0,i.kt)("p",{parentName:"li"},"a. Change name to HttpRequest_Create_Tenant"),(0,i.kt)("p",{parentName:"li"},"b. Click on the building block to open the right side panel and complete the following fields"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre"},'i. method: POST\n\nii. host: $IPAddressDI+"/retinaserver"\n\niii. protocol: https\n\niv. headers:\n\n        {\n            "Content-Type": "application/json",\n            "X-Auth-Token": $HttpRequest_Get_DI_Token.result.data.authenticate.token\n        }\n        \nv. body: "{\\"query\\":\\"mutation {\\\\r\\\\n    createTenant (\\\\r\\\\n        tenant: {\\\\r\\\\n            name: \\\\\\"" + $ForEach_Device.item.device.customer + "\\\\\\",\\\\r\\\\n            nmsRoleId: " + $roleid + "\\\\r\\\\n        }\\\\r\\\\n    )\\\\r\\\\n    {\\\\r\\\\n        id\\\\r\\\\n        name\\\\r\\\\n    }\\\\r\\\\n}\\",\\"variables\\":{}}"\n'))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Add a new buildig block, Common -> HttpRequest"),(0,i.kt)("p",{parentName:"li"},"a. Change name to HttpRequest_Get_Datasource"),(0,i.kt)("p",{parentName:"li"},"b. Click on the building block to open the right side panel and complete the following fields"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre"},'i. method: POST\n\nii. host: $IPAddressDI+"/retinaserver"\n\niii. protocol: https\n\niv. headers:\n\n        {\n            "Content-Type": "application/json",\n            "X-Auth-Token": $HttpRequest_Get_DI_Token.result.data.authenticate.token\n        }\n        \nv. body: "{\\"query\\":\\"query {\\\\r\\\\n    datasources\\\\r\\\\n    {\\\\r\\\\n        id\\\\r\\\\n        name\\\\r\\\\n    }\\\\r\\\\n}\\",\\"variables\\":{}}"\n'))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Add a new buildig block, Common -> HttpRequest"),(0,i.kt)("p",{parentName:"li"},"a. Change name to HttpRequest_Assign_Datasource"),(0,i.kt)("p",{parentName:"li"},"b. Click on the building block to open the right side panel and complete the following fields"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre"},'i. method: POST\n\nii. host: $IPAddressDI+"/retinaserver"\n\niii. protocol: https\n\niv. headers:\n\n        {\n            "Content-Type": "application/json",\n            "X-Auth-Token": $HttpRequest_Get_DI_Token.result.data.authenticate.token\n        }\n        \nv. body: "{\\"query\\":\\"mutation {\\\\r\\\\n    addTenantDatasource (\\\\r\\\\n        datasourceId: " + $HttpRequest_Get_Datasource.result.data.datasources[0].id + ",\\\\r\\\\n        tenantId: " + $HttpRequest_Create_Tenant.result.data.createTenant.id + ",\\\\r\\\\n        useAsAuthsource: true,\\\\r\\\\n        useAsDatasource: true\\\\r\\\\n    )\\\\r\\\\n    {\\\\r\\\\n        id\\\\r\\\\n        name\\\\r\\\\n    }\\\\r\\\\n}\\\\r\\\\n\\\\r\\\\n\\\\r\\\\n\\",\\"variables\\":{}}"\n')))),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"IBM SevOne Automated Network Observability",src:n(80219).Z,width:"924",height:"686"}),"\t"),(0,i.kt)("h2",{id:"review"},"Review"),(0,i.kt)("ol",{start:42},(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Run the workflow, it should finish without errors")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Go to the NMS")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Go to Devices -> Device Manager"),(0,i.kt)("p",{parentName:"li"},"a. There should be three new devices that were not before:"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre"},"1. MAD-FW02\n\n2. MAD-FW01\n\n3. BRG-EDGE01\n")))),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"IBM SevOne Automated Network Observability",src:n(5930).Z,width:"1310",height:"626"}),"\t"),(0,i.kt)("ol",{start:45},(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Go to Devices -> Grouping -> Device Groups"),(0,i.kt)("p",{parentName:"li"},"a. There should be two new groups:"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre"},"i. CustomerA: including the two MAD devices\n\nii. CustomerB: including the BRG device\n")))),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"IBM SevOne Automated Network Observability",src:n(89282).Z,width:"920",height:"443"}),"\t"),(0,i.kt)("ol",{start:46},(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Go to Administration -> Access Configuration-> User Role Manager"),(0,i.kt)("p",{parentName:"li"},"a. Expand System Administrators -> Administrators to find the new roles created"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre"},"1. CustomerA: click on it to see the permissions and click on Devices and Device Groups Access to review the access\n")))),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"IBM SevOne Automated Network Observability",src:n(48638).Z,width:"1908",height:"531"})),(0,i.kt)("ol",{start:47},(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Go to Administration -> Access Configuration -> User Manager"),(0,i.kt)("p",{parentName:"li"},"a. There should be two new users:"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre"},"i. CustomerA: assigned to role CustomerA\n\nii. CustomerB: assigned to role CustomerB\n")))),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"IBM SevOne Automated Network Observability",src:n(29567).Z,width:"1917",height:"227"})),(0,i.kt)("ol",{start:48},(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Go to DI and login using the admin user and SevOne tenant")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Select all the reports you have in All Reports folder"),(0,i.kt)("p",{parentName:"li"},"a. click on Permissions"),(0,i.kt)("p",{parentName:"li"},"b. User Access: Multi-tenant"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre"},"i. Tenants: All Tenants\n")))),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"IBM SevOne Automated Network Observability",src:n(3385).Z,width:"1723",height:"911"})),(0,i.kt)("ol",{start:50},(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Do the same with All Templates")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Logout and login using:"),(0,i.kt)("p",{parentName:"li"},"a. Tenant: CustomerA"),(0,i.kt)("p",{parentName:"li"},"b. User: CustomerA"),(0,i.kt)("p",{parentName:"li"},"c. Password: CustomerA")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Go to Network Performance Report, and click on the variable Devices to see the devices available on this tenant"))),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"IBM SevOne Automated Network Observability",src:n(99903).Z,width:"1737",height:"891"})),(0,i.kt)("ol",{start:53},(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Log out and do the same with CustomerB"),(0,i.kt)("p",{parentName:"li"},"a. Tenant: CustomerB"),(0,i.kt)("p",{parentName:"li"},"b. User: CustomerB"),(0,i.kt)("p",{parentName:"li"},"c. Password: CustomerB"))),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"IBM SevOne Automated Network Observability",src:n(91437).Z,width:"1725",height:"902"})),(0,i.kt)("ol",{start:54},(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"To test how dynamic this workflow is, go back to RNA, open the workflow and edit the ListDevices variable:"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre"},'    [\n        { \n            "device": {\n                "name": "MAD-FW01",\n                "ip": "172.24.147.228",\n                "snmp": "public",\n                "customer": "CustomerA"\n            }\n        },\n        { \n            "device": {\n                "name": "MAD-FW02",\n                "ip": "172.24.147.130",\n                "snmp": "public",\n                "customer": "CustomerA"\n            }\n        },\n        { \n            "device": {\n                "name": "BRG-EDGE01",\n                "ip": "172.24.147.5",\n                "snmp": "public",\n                "customer": "CustomerB"\n            }\n        },\n        { \n            "device": {\n                "name": "MAN-EDGE01",\n                "ip": "172.24.147.3",\n                "snmp": "public",\n                "customer": "NewCustomerC"\n            }\n        }\n\n    ]\n    \n')))),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"IBM SevOne Automated Network Observability",src:n(85454).Z,width:"1899",height:"675"})),(0,i.kt)("ol",{start:55},(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Run the workflow again")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Go back to DI and login using NewCustomerC tenant:"),(0,i.kt)("p",{parentName:"li"},"a. Tenant: NewCustomerC"),(0,i.kt)("p",{parentName:"li"},"b. User: NewCustomerC"),(0,i.kt)("p",{parentName:"li"},"c. Password: NewCustomerC"))),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"IBM SevOne Automated Network Observability",src:n(54030).Z,width:"1732",height:"895"})),(0,i.kt)("p",null,"NOTE: in your instance there will be no alerts triggered for this device"))}c.isMDXComponent=!0},83351:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/Img1-ee5e510d0e0ff3ba9618fef58df14677.png"},81773:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/Img1-39afbe7270ab90c18bc90b25890b43f8.png"},48638:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/Img10-1a3f7e8caaf71446ca7ae8203760112e.png"},29567:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/Img11-8e72275415d8172a7e1c02a0fd79fabc.png"},3385:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/Img12-5ef93f5ad0052ebce02bde2a5de1bf7c.png"},99903:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/Img13-f54f8693f56784b6da83cf463fa9b06a.png"},91437:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/Img14-72d284658250af652f8ea6563b7ecb05.png"},85454:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/Img15-5cfc6d5d53731365eddeb6172f212493.png"},54030:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/Img16-a736aa6f53aefbfeab1cb8f6f9ffa3fc.png"},70692:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/Img2-e75ec3de95e3f202c54e3ffd79e77159.png"},76552:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/Img3-0d837a9995edc5c6de634ec78c7adc04.png"},83524:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/Img4-467d4f233cf2159d21443623fe7a8a49.png"},1066:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/Img5-3929d0fe06a93751fe3f4aa85ddc39f1.png"},38940:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/Img6-b41215857f45e80cb9dd29bee513187f.png"},80219:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/Img7-41287f7ce9793b26a94c7b399050a9ea.png"},5930:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/Img8-2c1c06b11dd7af5f855e50f3a881a0c1.png"},89282:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/Img9-0b1c7dac28153397003d06385fb942ca.png"}}]);